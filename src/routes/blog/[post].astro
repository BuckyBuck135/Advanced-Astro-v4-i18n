---
import { getCollection } from "astro:content";
import { slugify, formatDate } from "@utils/utils.js";
import { Image } from "astro:assets";
import { getLocalePlaceholder, t } from "i18n:astro";
import { collectionFilters } from "@astrolicious/i18n/content-collections"
import BaseLayout from "src/layouts/BaseLayout.astro";
import Landing from "@components/Landing.astro";
import FeaturedPost from "@components/FeaturedPost.astro";

// Generates paths for blog posts, filtered by locale.
export const getStaticPaths = (async () => {
    const locale = getLocalePlaceholder();
    const posts = await getCollection("blog", (post) =>
      collectionFilters.byLocale(post, { locale }),
    );
    return posts.map((entry) => ({
      params: { post: slugify(entry.slug) },
      props: { post: entry },
    }));
  })

const { post } = Astro.props;
const { title, date, description, image, imageAlt, author } = post.data;
const { Content } = await post.render();
console.log(post)
---

<BaseLayout 
  title={t("blog:landing")}
  description="Meta description for the page"
>

  <Landing 
    title={t("blog:landing")}
  />

  <section class="main-content-wrapper">
    <!--Main content -->
    <div class="main-content">
      <article class="blog-article">
        <!--Main Article Image-->
        <picture class="blog-mainImage">
          <Image
            src={image}
            alt={imageAlt}
            width="795"
            height="400"
            decoding="async"
          />
        </picture>

        <!--Article Info-->
        <div class="article-group">
          <h2 class="blog-h1">{title}</h2>
          <div class="blog-authorGroup">
            <!--Author Image-->
            <picture class="blog-author-img">
              <img
                src="/assets/svgs/profile.svg"
                alt="house"
                width="32"
                height="32"
                decoding="async"
              />
            </picture>
            <span class="blog-author">{author}</span>
            <span aria-hidden="true" class="blog-dot"></span>
            <!--Blog Date-->
            <span class="blog-date">{formatDate(date)}</span>
          </div>
        </div>
        <section id="blog-content">
          <Content />
        </section>
      </article>
    </div>
    <FeaturedPost />
  </section>

  
</BaseLayout>

<style lang="less">
  /* Mobile - 360px */
@media only screen and (min-width: 0em) {

    .main-content-wrapper {
      padding: var(--sectionPadding);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      row-gap: (50/16em);
    }

    .main-content {
        width: 100%;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        row-gap: (50/16em);
    }
}

/* Tablet - 1024px */
@media only screen and (min-width: 64em) {
    .main-content-wrapper {
        flex-direction: row;
        align-items: flex-start;
        column-gap: (20/16em);
    }
}
</style>